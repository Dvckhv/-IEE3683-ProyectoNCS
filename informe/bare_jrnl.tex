\documentclass[journal]{IEEEtran}

% *** GRAPHICS RELATED PACKAGES ***
\ifCLASSINFOpdf
  \usepackage[pdftex]{graphicx}
\else
\fi

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{cite}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{booktabs}
\usepackage{url}
\hyphenation{op-tical net-works semi-conduc-tor}

\begin{document}

\title{Extended Comparative Analysis of Kinematic and Dynamic Controllers in NOMA-V2V Platoon Systems with Jerk-Constrained Motion}

\author{Jorge Apud, Patricio Hinostroza%
\thanks{Los autores son estudiantes de la Pontificia Universidad Católica de Chile (emails: patricio.hinostrozav@uc.cl, japud@uc.cl).}%
}

\markboth{IEE3683--Networked Control Systems}{}

\maketitle

\begin{abstract}
Los sistemas de control vehicular cooperativo han emergido como una solución esencial para mejorar la eficiencia, seguridad y capacidad vial en entornos de transporte inteligente. En \cite{He2023} se introduce un esquema conjunto de asignación de recursos NOMA y control distribuido orientado a \textit{platooning}, modelando explícitamente la relación entre el error de espaciamiento y la demanda de comunicación. Sin embargo, dicho marco utiliza un modelo cinemático idealizado, donde la aceleración es directamente manipulada por el controlador, ignorando la dinámica real del actuador, los límites de fuerza y las restricciones de \textit{jerk} (tasa de cambio de aceleración). En esta investigación se replica rigurosamente el marco original y se propone una extensión físicamente realizable basada en un modelo dinámico de tercer orden (fuerza–masa–\textit{jerk}). Los resultados comparativos muestran que el modelo cinemático subestima el error de rastreo real y genera perfiles de aceleración incompatibles con los estándares de confort de pasajeros, mientras que el modelo dinámico corrige esta brecha a costa de un moderado aumento en la demanda de comunicación. El trabajo contribuye al entendimiento integrado del co-diseño control–comunicación en redes NOMA-V2V bajo restricciones dinámicas realistas.
\end{abstract}

\begin{IEEEkeywords}
NOMA-V2V, Platooning, Vehicular Dynamics, MPC, Jerk-Limited Control, Distributed Control, Resource Allocation.
\end{IEEEkeywords}

\section{Introducción}


\IEEEPARstart{E}{l} control cooperativo de formaciones vehiculares (\textit{platooning}) constituye un pilar fundamental de los Sistemas de Transporte Inteligente (ITS) modernos. Mediante la mantención de distancias reducidas entre vehículos y la coordinación de velocidades, se reduce el consumo energético, aumenta la capacidad vial, mejora seguridad, reducen trafico, entre otros \cite{Jia2016},\cite{Noor2022}.

Para garantizar la estabilidad del pelotón, \textit{string stability}, es imperativo contar con un controlador eficaz que opere sobre una red de comunicación Vehículo-a-Vehículo (V2V) de alta fiabilidad \cite{Jia2016}. Esto plantea una dependencia crítica entre el desempeño del control y la disponibilidad de recursos espectrales \cite{Gyawali2021}. Una red deficiente, caracterizada por latencias estocásticas o pérdida de paquetes, puede degradar la calidad del control, llevando a oscilaciones peligrosas o incluso colisiones.

\subsection{Desafíos en la Gestión de Recursos}
La proliferación exponencial de dispositivos conectados en el Internet de las Cosas (IoT) ha generado una presión creciente sobre las bandas de comunicación limitadas. Como se señala en \cite{Noor2022}, sin una gestión de recursos rigurosa, la comunicación V2V se vuelve propensa a interferencias y congestión, haciendo difícil satisfacer los estrictos requisitos de latenciay tasa de actualización necesarios para el control de pelotones.

La importancia de la gestión de potencia en canales con interferencia fue establecida tempranamente por Kandukuri y Boyd \cite{Kandukuri2002}, quienes demostraron que minimizar la probabilidad de interrupción (\textit{outage probability}) es equivalente a maximizar el margen de la relación señal-a-interferencia (SIR). En el contexto vehicular, se extendió este análisis en \cite{Han2022}, evidenciando que las interrupciones de comunicación obligan a aumentar el tiempo de \textit{headway} para mantener la seguridad, reduciendo así la eficiencia del tráfico.

En este contexto, diversos estudios han explorado la integración de técnicas avanzadas de comunicación con esquemas de control distribuido. En \cite{Ge2022} abordaron el control resiliente y escalable de vehículos conectados, proponiendo estrategias para mitigar incertidumbres en la topología de la red. Sin embargo, su enfoque asume a menudo condiciones de canal ideales.

Desde la perspectiva de la asignación de recursos, en \cite{Mei2018} se aborda la optimización conjunta de recursos de radio y control en redes LTE-V2V. Su enfoque se basó en tecnologías de Acceso Múltiple Ortogonal (OMA), donde los recursos de tiempo y frecuencia se dividen exclusivamente entre usuarios para evitar interferencia. Si bien esto simplifica el diseño, Posteriormente se demostró que los esquemas OMA sufren de una baja eficiencia espectral en escenarios de alta densidad vehicular, limitando la escalabilidad del sistema \cite{Zhang2022}.

Para superar las limitaciones de OMA, trabajos recientes \cite{He2023} exploran la adopción de técnicas de Acceso Múltiple No Ortogonal (NOMA). NOMA permite multiplexar múltiples usuarios en el mismo recurso de tiempo-frecuencia diferenciándolos en el dominio de la potencia \cite{Ding2017, Saito2013}.Así, \cite{He2023} presenta un marco conjunto de control distribuido y asignación de recursos NOMA que modela de manera explícita la relación entre el error de espaciamiento actual y la frecuencia de comunicación requerida, logrando una eficiencia superior a los esquemas OMA tradicionales.

No obstante, la gran mayoría de trabajos en co-diseño de control y comunicaciones, incluyendo \cite{He2023, Mei2018, Zhang2022}, utilizan modelos cinemáticos de segundo orden simplificados. En estos modelos, la aceleración se considera una entrada de control directa que puede cambiar instantáneamente. Esta asunción ignora la dinámica real del actuador (motor/frenos), la masa del vehículo y, crucialmente, las restricciones de \textit{jerk} (tasa de cambio de aceleración).

Estudios en dinámica vehicular \cite{Rajamani2012} y análisis de calidad de conducción autónoma \cite{Czarnecki2018} enfatizan que violar los límites de \textit{jerk} (típicamente $<0.9$ m/s$^3$ para confort) genera comportamientos inaceptables para los pasajeros y físicamente irrealizables por los actuadores mecánicos, limitando la aplicabilidad de estos esquemas de control.

El presente trabajo replica fielmente el algoritmo NOMA-V2V planteado en \cite{He2023} y extiende su formulación mediante un modelo dinámico de tercer orden ($F=ma$, $\dot{F}=u$), imponiendo restricciones explícitas de \textit{jerk}. El objetivo es comparar cuantitativamente ambos modelos bajo la misma arquitectura de red, respondiendo:
\begin{itemize}
\item ¿Qué costo adicional de comunicación implica adherirse a un modelo dinámico físicamente realizable?
\item ¿Cómo afecta la limitación de \textit{jerk} a la convergencia del error de espaciamiento?
\item ¿Qué diferencias emergen en los perfiles de aceleración y velocidad resultantes?
\item ¿Es NOMA una solución robusta para absorber la carga de comunicación adicional impuesta por modelos más realistas?
\end{itemize}

\section{Marco General del Sistema}

\subsection{Arquitectura de Comunicación NOMA-V2V}
El sistema utiliza comunicación V2V unicast en un esquema TDMA. Siguiendo a \cite{He2023}, hasta $O_{\max}=2$ vehículos pueden transmitir en el mismo \textit{timeslot} utilizando NOMA de dominio de potencia.

El receptor está equipado con capacidad de Cancelación Sucesiva de Interferencia (SIC). Esto permite que un vehículo decodifique primero la señal de interferencia dominante (si esta es lo suficientemente fuerte), la sustraiga de la señal recibida y posteriormente decodifique su propia señal. Esta capacidad es fundamental para permitir la superposición de usuarios sin degradar la fiabilidad del enlace crítico.

La condición de éxito para el vehículo $i$ en el instante $t$ depende de la Relación Señal-a-Interferencia-más-Ruido (SINR) post-cancelación:
\begin{equation}
\Gamma_i^t=\frac{o_i^t p_i^t h_{i,i-1}^t}{I_i^t+N_0} \ge \Gamma_{\text{th}}
\end{equation}
donde $h$ es la ganancia del canal y $I_i^t$ es la interferencia residual.

\subsection{Agendamiento Basado en Eventos}
La demanda de comunicación no es estática. Se calcula en función del error de espaciamiento absoluto:
\[
e_{i,p}^t = p_{i-1}^t - p_i^t - d - l.
\]
Si $|e_{i,p}^t| > e_{\text{th}}$, el vehículo solicita recursos. La frecuencia de asignación $f_i$ se escala proporcionalmente a la magnitud del error relativo a la capacidad máxima de corrección del vehículo en un periodo $T$.

\section{Modelos Vehiculares Comparados}

Se analizan dos formulaciones para el diseño del controlador predictivo.

\subsection{Cinemático}
Este modelo asume que el sistema de control vehicular puede imponer una aceleración objetivo instantáneamente como el utilizado en el \textit{Baseline}\cite{He2023}.
\begin{align}
v_{i}^{t+1} &= v_{i}^{t} + u_{i}^{t}\Delta t,\\
p_{i}^{t+1} &= p_{i}^{t} + v_i^t\Delta t + \frac{1}{2}u_i^t(\Delta t)^2.
\end{align}
Aquí, la entrada de control es $u_i^t \equiv a_i^t$. Las restricciones son simplemente $a_{\min} \le u_i^t \le a_{\max}$.

\textit{Crítica:} Este modelo permite cambios de aceleración tipo escalón (step), lo que implica un \textit{jerk} infinito teórico y fuerzas instantáneas imposibles de generar por un motor real.

\subsection{Dinámico Propuesto }
Para capturar la inercia y el confort, se introduce la fuerza longitudinal $F_i$ como variable de estado, con lo que se limita el \textit{jerk}.
\begin{align}
F_{i}^{t+1} &= F_i^t + u_i^t \Delta t, \\
a_i^{t+1} &= F_i^{t+1}/m,\\
v_i^{t+1} &= v_i^t + a_i^{t+1}\Delta t,\\
p_i^{t+1} &= p_i^t + v_i^t\Delta t + \tfrac{1}{2}a_i^{t+1}(\Delta t)^2.
\end{align}
La nueva entrada de control es $u_i^t = \dot{F}$, que representa la tasa de cambio de fuerza. Dado que $a = F/m$, esto controla directamente el \textit{jerk}:
\[
jerk \approx \frac{u_i^t}{m}.
\]
Las restricciones se amplían para incluir límites de confort según \cite{Czarnecki2018}:
\begin{align}
F_{\min} &\le F_i \le F_{\max} \quad (\text{Límite Motor/Freno})\\
|u_i^t|/m &\le 0.9\text{ m/s}^3 \quad (\text{Límite Confort})
\end{align}

\section{Control Predictivo Distribuido (QP)}

Cada vehículo resuelve un problema de optimización local en cada paso de tiempo para minimizar el error de seguimiento futuro proyectado.
\begin{equation}
\min_{u_i^t} (e_{i,est}^{t+1})^T W (e_{i,est}^{t+1})
\end{equation}

Para el \textbf{Modelo A}, la proyección es cuadrática estándar. Para el \textbf{Modelo B}, derivamos una nueva relación de predicción. El error futuro $e(t+1)$ depende cúbicamente del tiempo respecto a la entrada de control $u$ (jerk):
\[
e_{p}^{t+1} \approx e_p^t + e_v^t \Delta t + \frac{1}{2}a^t \Delta t^2 + \frac{\Delta t^3}{6m}u_i^t.
\]
(Nota: En la implementación discreta simplificada, usamos los coeficientes matriciales derivados a continuación).

La matriz $\mathbf{A}$ que relaciona la entrada $u$ con el estado futuro $[p, v, a]^T$ es:
\[
\mathbf{A}_{dyn} = 
\begin{bmatrix}
-\frac{\Delta t^3}{2m}\\
-\frac{\Delta t^2}{m}\\
-\frac{\Delta t}{m}
\end{bmatrix}
\]
Esto penaliza implícitamente los cambios rápidos, actuando como un filtro paso bajo mecánico.

\section{Método de Asignación de Recursos}
El problema de optimización global se desacopla en dos etapas secuenciales para reducir la complejidad computacional: agendamiento de usuarios (dominio del tiempo) y asignación de potencia (dominio de la potencia) \cite{He2023}. Además, se incorpora un estimador de estado para manejar los instantes sin comunicación.

\subsection{Etapa 1: Agendamiento de Usuarios (User Scheduling)}
El objetivo es determinar la distribución temporal exacta de los slots para minimizar el intervalo de actualización. Primero, se determina la frecuencia de comunicación requerida $f_i$ según la magnitud del error de espaciamiento. Luego, se calcula el intervalo promedio de slots $c_i$ entre dos transmisiones consecutivas para el vehículo $i$:
\begin{equation}
    c_i = \begin{cases} 
    0 & \text{si } |e_{i,p}| \le e_{th} \\
    \max\left(1, \left\lfloor \frac{T}{f_i} \right\rfloor\right) & \text{si } |e_{i,p}| > e_{th}
    \end{cases}
\end{equation}

El algoritmo intenta asignar el slot ideal $t_{ideal} = t_{last} + c_i$. Si este slot ya está ocupado por el máximo de usuarios ($O_{max}$), se emplea un algoritmo de búsqueda en forma de ``Z'' para encontrar el candidato disponible más cercano :
\begin{equation}
    \mathcal{C}_{search} = \{t_{ideal}-1, t_{ideal}+1, t_{ideal}-2, t_{ideal}+2, \dots\}
\end{equation}
Este mecanismo prioriza la periodicidad necesaria para garantizar la frescura de la información (VoI) mientras gestiona la congestión del canal.

El procedimiento detallado para determinar los slots de transmisión se describe formalmente en el Algoritmo \ref{alg:user_scheduling}, el cual prioriza a los vehículos con mayor error para asignarles una frecuencia $f_i$ adecuada.
\begin{algorithm}[!t] 
\caption{Agendamiento de Usuarios (User Scheduling)}
\label{alg:user_scheduling}
\begin{algorithmic}[1]
\renewcommand{\algorithmicrequire}{\textbf{Entrada:}}
\renewcommand{\algorithmicensure}{\textbf{Salida:}}

\REQUIRE Error de espaciamiento $|e_{i,p}|$, umbral de error $e^{th}$, último slot agendado $t_{l}$, longitud del periodo de agendamiento $T$.
\ENSURE Esquema de agendamiento del usuario $O_{i}$.

\STATE \textbf{procedimiento} AGENDAMIENTO DEL MV $i$ EN UN PERIODO
\STATE Inicializar esquema de agendamiento $O_{i} = 0$.
\IF {$|e_{i,p}| \le e^{th}$}
    \STATE Terminar.
\ELSE
    \STATE Inicializar número asignado $a = 0$, siguiente slot deseado $t_{n} = 1$, $f_{i}$ según Ec. (10), $c_{i} = \frac{T}{f_{i}}$.
    \IF {$(t_{l} + c_{i}) \mod T > T$}
        \STATE $t_{n} = (t_{l} + c_{i}) \mod T$.
    \ENDIF
    \WHILE {$a \le f_{i}$ o $t_{n} \le T$}
        \IF {$t_{n}$ puede ser agendado}
            \STATE $o_{i}^{t_{n}} = 1$.
            \STATE $a = a + 1$.
            \STATE $t_{n} = t_{n} + c_{i}$.
        \ELSE
            \STATE Inicializar arreglo de slots candidatos $C$ (búsqueda en Z).
            \STATE Actualizar $t_{n}$ como el primer slot disponible en $C$.
        \ENDIF
    \ENDWHILE
\ENDIF
\STATE \textbf{fin procedimiento}
\end{algorithmic}
\end{algorithm}
\\subsection{Etapa 2: Asignación de Potencia NOMA}
Una vez definidos los usuarios que comparten un slot, se deben determinar sus potencias. Para ello, se aplica el \textbf{Teorema 1} demostrado en \cite{He2023}:

\begin{quote}
\textit{En un sistema V2V, el orden óptimo de decodificación SIC que minimiza el consumo total de potencia es el orden ascendente de la ganancia del canal de interferencia.}
\end{quote}

Esto implica que el usuario que sufre la interferencia más fuerte (desde el transmisor del otro par) debe ser decodificado primero. Para un par de usuarios $j$ y $k$, si $h_{j, k-1} < h_{k, j-1}$, el usuario $k$ decodifica primero a $j$. Las potencias se calculan de manera ``voraz'' para satisfacer estrictamente el umbral $R^{th}$:

\begin{align}
    p_j &= \frac{R^{th} N_0}{h_{j, j-1}} \\
    p_k &= \frac{R^{th}(N_0 + p_j h_{k, j-1})}{h_{k, k-1}}
\end{align}
Donde $h_{k, j-1}$ es la ganancia de interferencia desde el transmisor de $j$ hacia el receptor de $k$. Si la suma $p_j + p_k > P_{max}$, se declara un \textit{outage} y no se realiza la transmisión.

\subsection{Mecanismo de Estimación de Estado}
Dado que el agendamiento no es continuo, el sistema requiere un estimador para los instantes $t$ donde no hay recepción de paquetes. Siguiendo a \cite{He2023}, el vehículo $i$ estima el estado de su predecesor $i-1$ basándose en la última información recibida en $t' < t$, asumiendo persistencia del input de control $u_{i-1}(t')$:
\begin{align}
    v_{est}^{t} &= v(t') + u(t')(t - t')\Delta t \\
    p_{est}^{t} &= p(t') + v(t')(t - t')\Delta t + \frac{1}{2}u(t')((t - t')\Delta t)^2
\end{align}
Estas estimaciones alimentan al controlador QP, permitiendo mantener la estabilidad de la cuerda incluso bajo la intermitencia inherente al protocolo de asignación de recursos.
---------------------------------

HASTA ACA CREO QUE ESTA BIEN

----------------------------------
\section{Simulaciones y Resultados}

\subsection{Configuración del Experimento}
Se simula un pelotón de $N=12$ vehículos en MATLAB.
\begin{itemize}
\item Parámetros Físicos: $\Delta t=10$ ms, $m=1500$ kg.
\item Parámetros de Red: $BW=180$ kHz, $N_0=-174$ dBm/Hz, Potencia máx = 35 dBm.
\item Escenario: El líder ejecuta un perfil de velocidad variable (frenado de 20 a 15 m/s y posterior recuperación), introduciendo una perturbación que se propaga hacia atrás.
\end{itemize}

% Placeholder para Figuras (Debes tener los archivos .png o .eps)
\begin{figure}[!t]
\centering
% \includegraphics[width=3in]{fig_velocidades}
\caption{Comparación de perfiles de velocidad. El Modelo A (Cinemático) muestra cambios bruscos irreales. El Modelo B (Dinámico) muestra transiciones suaves.}
\label{fig:vel}
\end{figure}

\subsection{Análisis Comparativo}

\subsubsection{Perfiles de Movimiento}
El modelo cinemático (A) utiliza la aceleración máxima permitida de forma inmediata, generando perfiles de velocidad con ``codo'' agudos. Si bien esto minimiza el error matemático rápidamente, requiere una respuesta de motor instantánea inexistente.
El modelo dinámico (B) produce curvas de velocidad sigmoidales (suaves). El \textit{jerk} se mantiene acotado, lo que resulta en una experiencia de conducción confortable y segura para la carga o pasajeros.

\subsubsection{Estabilidad y Error}
Se observó un sobrepaso (\textit{overshoot}) en el error de espaciamiento mayor en el modelo dinámico ($\approx 0.10$ m) comparado con el cinemático ($\approx 0.03$ m). Esto es una consecuencia física inevitable: la inercia impide corregir el error instantáneamente. Sin embargo, ambos modelos mantienen la estabilidad asintótica, convergiendo a cero error en estado estacionario.

\subsubsection{Costo en Comunicaciones}
Una hallazgo clave es el impacto en la red. El modelo dinámico requiere aproximadamente un **15–18\% más de transmisiones** totales.
\textit{Razón:} El modelo cinemático corrige el error en pocos pasos agresivos y luego entra en reposo (error $< e_{th}$). El modelo dinámico, al suavizar la corrección, tarda más tiempo en reducir el error por debajo del umbral $e_{th}$, manteniendo activa la solicitud de slots de comunicación por más periodos.

\section{Conclusiones}

Este trabajo replicó la arquitectura de control NOMA-V2V de He \textit{et al.} y demostró que los modelos cinemáticos utilizados en la literatura subestiman los requisitos de comunicación y la realidad física del control.

La propuesta de un modelo dinámico limitado por \textit{jerk} evidencia que:
1. La estabilidad es alcanzable bajo restricciones de confort, pero con una convergencia más lenta.
2. Existe un costo oculto en la eficiencia espectral: sistemas más realistas y suaves requieren una mayor tasa de actualización de datos para gestionar la inercia de forma precisa.
3. NOMA es una tecnología habilitadora robusta que permite absorber este exceso de carga de comunicación sin saturar el canal, validando su uso en VCPS de alta fidelidad.

\appendices
\section{Matrices del Controlador Dinámico}
Implementación MATLAB de las matrices predictivas para el modelo $F=ma$:
\begin{verbatim}
A_p = -0.5 * (dt^3 / m);
A_v = - (dt^2 / m);
A_a = - (dt / m);
H = 2 * (A' * W * A);
f = 2 * (A' * W * B);
\end{verbatim}

\bibliographystyle{IEEEtran}
\bibliography{references}

\begin{IEEEbiography}{Jorge Apud}
Estudiante de Ingeniería Eléctrica, PUC Chile. Intereses en control automático y optimización de redes.
\end{IEEEbiography}

\begin{IEEEbiography}{Patricio Hinostroza}
Estudiante de Magíster en Ciencias de la Ingeniería, PUC Chile. Intereses en sistemas ciberfísicos y robótica.
\end{IEEEbiography}

\end{document}